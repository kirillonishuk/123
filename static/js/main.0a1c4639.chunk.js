(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e){e.exports={bot:{type:"web",id:"762273404"}}},37:function(e,t,n){e.exports=n(79)},42:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},76:function(e,t){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(33),r=n.n(i),s=(n(42),n(19)),c=n(8),m=n(9),l=n(11),u=n(10),g=n(12),p=(n(44),n(46),n(34)),f=n.n(p),d=n(35),h=n.n(d),b=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).createFile=function(){var e=new Blob([n.props.file],{type:h.a.lookup(n.props.name.split(".")[1])});return URL.createObjectURL(e)},n.createAudio=function(){var e=new Blob([n.props.file],{type:n.props.mime});return URL.createObjectURL(e)},n.renderMessage={message:function(e){return o.a.createElement("div",{className:e},n.props.text)},image:function(e){return o.a.createElement("div",{className:e},o.a.createElement("img",{src:"data:image/png;base64,".concat(n.props.image),alt:"sending"}))},file:function(e){return o.a.createElement("div",{className:e},o.a.createElement("a",{href:n.createFile(),download:n.props.name,className:"file-download"},n.props.name),o.a.createElement("div",{className:"file-size"},"".concat(n.props.file.byteLength," \u0431\u0430\u0439\u0442")))},audio:function(e){return o.a.createElement("div",{className:e},o.a.createElement("audio",{controls:!0,className:"voice-msg"},o.a.createElement("source",{src:n.createAudio(),type:n.props.mime})))}},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=f()({outgoing:"outgoing"===this.props.type,incoming:"incoming"===this.props.type,image:"image"===this.props.form,"message-box":!0});return this.renderMessage[this.props.form](e)}}]),t}(a.Component),y=n(36),v=n.n(y),x={"component-outgoing-message":function(e){return{text:e.text,type:"incoming",form:"message"}},"component-ingoing-message":function(e){return{text:e.text,type:"outgoing",form:"message"}},"component-keyboard":function(e){var t="";return e.buttons.forEach(function(e,n,a){n!==a.length-1?t+="".concat(e.text,"/"):t+=e.text}),{text:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043e\u0442\u0432\u0435\u0442\u0430: ".concat(t),type:"incoming",form:"message"}},"component-outgoing-picture":function(e){return{image:e.image,filename:e.filename,type:"incoming",form:"image"}},"component-ingoing-picture":function(e){return{image:e.image,filename:e.filename,type:"outgoing",form:"image"}},"component-outgoing-audio":function(e){return{file:e.file,mime:e.mime,type:"incoming",form:"audio"}},"component-outgoing-document":function(e){return{file:e.file,name:e.name,type:"incoming",form:"file"}},default:function(e){return{text:e.text||"Error message!",type:"incoming",form:"message"}}},w=function(e){return e.type in x?x[e.type](e):x.default(e)},E=n(18),k=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).scrollToBottom=function(){n.chatbox&&(n.chatbox.scrollTop=n.chatbox.scrollHeight)},n.changeMessage=function(e){n.setState({text:e.target.value})},n.sendMessage=function(e){e.preventDefault();var t={bot:{type:E.bot.type,id:n.state.botId},user:n.state.userId};n.state.text&&(t=Object(s.a)({},t,{type:"message",text:n.state.text})),n.state.image&&(t=Object(s.a)({},t,{image:n.state.image.split(",")[1],filename:n.state.filename,type:"picture"})),t.type&&(n.socket.emit("web-chat",t),n.setState({image:"",text:"",filename:""}))},n.renderMessage=function(){return n.state.box.map(function(e,t){return o.a.createElement(b,Object.assign({key:t},e))})},n.startChat=function(){n.socket.emit("web-chat",{bot:{type:E.bot.type,id:n.state.botId},user:n.state.userId,text:"/start",type:"message"})},n.loadImage=function(e){var t=e.target.files;if(console.log(t),FileReader&&t&&t.length){var a=new FileReader;a.onload=function(){n.setState({image:a.result,filename:o})};var o=t[0].name,i=t[0];e.target.files=null,a.readAsDataURL(i),n.chat.focus()}else alert("Error!")},n.state={botId:"",userId:(new Date).getTime()*Math.floor(999*Math.random()+1),text:"",box:[],image:"",filename:""},n.socket=v()("wss://193.124.114.63:3015",{path:"/ws",transports:["websocket"]}),n.socket.on("web-bot-message",function(e){var t=w(e);n.setState({box:n.state.box.concat(t)})}),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.state.box.length!==t.box.length&&this.scrollToBottom()}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"bot-connection"},o.a.createElement("label",{htmlFor:"bot-id"},"Bot:ID "),o.a.createElement("input",{type:"text",id:"bot-id",value:this.state.botId,onChange:function(t){e.setState({botId:t.target.value})}})),o.a.createElement("div",{className:"App",ref:function(t){e.chatbox=t}},this.renderMessage()),this.state.box.length?o.a.createElement("form",{onSubmit:this.sendMessage},o.a.createElement("input",{ref:function(t){return e.chat=t},autoFocus:!0,className:"chat-input App-input",value:this.state.text,onChange:this.changeMessage,type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."}),o.a.createElement("label",{htmlFor:"select-file",className:"custom-input-file"}),o.a.createElement("input",{type:"file",id:"select-file",accept:"image/*",onChange:this.loadImage})):o.a.createElement("button",{className:"chat-input start-chat-btn",onClick:this.startChat},"Start"),this.state.image?o.a.createElement("img",{src:this.state.image,className:"selected-image",alt:"selected"}):null)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,2,1]]]);
//# sourceMappingURL=main.0a1c4639.chunk.js.map
